<div class="wrapper">
        <div class="page-header page-header-mini">
            <div class="page-header-image" data-parallax="true" style="background-image: url('../assets/img/pp-cov.jpg') ;">
            </div>
        </div>
        <div class="section">
            <div class="container">
                <div class="row">
                    <div class="col-md-5" style="margin-top: -10%">
                        <div id="productCarousel" class="carousel slide" data-ride="carousel" data-interval="8000">
                            <ol class="carousel-indicators">
                                <li data-target="#productCarousel" data-slide-to="0" class="active"></li>
                                <li data-target="#productCarousel" data-slide-to="1"></li>
                                <li data-target="#productCarousel" data-slide-to="2"></li>
                                <li data-target="#productCarousel" data-slide-to="3"></li>
                            </ol>
                            <div class="carousel-inner" role="listbox">
                                <div class="carousel-item active">
                                    <img class="d-block img-raised" src="../assets/img/pp-1.jpg" alt="First slide">
                                </div>
                                <div class="carousel-item">
                                    <img class="d-block img-raised" src="../assets/img/pp-2.jpg" alt="Second slide">
                                </div>
                                <div class="carousel-item">
                                    <img class="d-block img-raised" src="../assets/img/pp-3.jpg" alt="Third slide">
                                </div>
                                <div class="carousel-item">
                                    <img class="d-block img-raised" src="../assets/img/pp-4.jpg" alt="Third slide">
                                </div>
                            </div>
                            <a class="carousel-control-prev" href="#productCarousel" role="button" data-slide="prev">
                                <button type="button" class="btn btn-primary btn-icon btn-round btn-sm" name="button">
                                    <i class="now-ui-icons arrows-1_minimal-left"></i>
                                </button>
                            </a>
                            <a class="carousel-control-next" href="#productCarousel" role="button" data-slide="next">
                                <button type="button" class="btn btn-primary btn-icon btn-round btn-sm" name="button">
                                    <i class="now-ui-icons arrows-1_minimal-right"></i>
                                </button>
                            </a>
                        </div>
                        <p class="blockquote blockquote-primary">
                            "And thank you for turning my personal jean jacket into a couture piece. Wear yours with mirrored sunglasses on vacation."
                            <br>
                            <br>
                            <small>Kanye West</small>
                        </p>
                    </div>
                    <div class="col-md-6 ml-auto mr-auto">
                        <h2 class="title"> <%= @footprint.product.title %> </h2>
                        <h5 class="category"><%= @footprint.product.type.name %></h5>
                        <% if @footprint.product.price == nil %>
                        <h3> Prix n'est pas renseigné</h3>
                        <%else%>
                          <h2 class="main-price"><%= @footprint.product.price %></h2>
                        <%end%>
                        <div id="accordion" role="tablist" aria-multiselectable="true" class="card-collapse">
                            <div class="card card-plain">
                                <div class="card-header" role="tab" id="headingOne">
                                    <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        Description
                                        <i class="now-ui-icons arrows-1_minimal-down"></i>
                                    </a>
                                </div>
                                <div id="collapseOne" class="collapse show" role="tabpanel" aria-labelledby="headingOne">
                                    <div class="card-body">
                                        <p>Eres' daring 'Grigri Fortune' swimsuit has the fit and coverage of a bikini in a one-piece silhouette. This fuchsia style is crafted from the label's sculpting peau douce fabric and has flattering cutouts through the torso and back. Wear yours with mirrored sunglasses on vacation.</p>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="card card-plain"> -->
                                <!-- <div class="card-header" role="tab" id="headingTwo">
                                    <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                        Designer Information
                                        <i class="now-ui-icons arrows-1_minimal-down"></i>
                                    </a>
                                </div> -->
                                <!-- <div id="collapseTwo" class="collapse" role="tabpanel" aria-labelledby="headingTwo">
                                    <div class="card-body">
                                        <p>An infusion of West Coast cool and New York attitude, Rebecca Minkoff is synonymous with It girl style. Minkoff burst on the fashion scene with her best-selling 'Morning After Bag' and later expanded her offering with the Rebecca Minkoff Collection - a range of luxe city staples with a "downtown romantic" theme.</p>
                                    </div>
                                </div> -->
                            <!-- </div> -->
<p id="notice"><%= notice %></p>

<p>
  <strong>Delivery address:</strong>
  <%= @footprint.delivery_address %>
</p>

<p>
  <strong>Zip code:</strong>
  <%= @footprint.zip_code %>
</p>

<p>
  <strong>Town:</strong>
  <%= @footprint.town %>
</p>

<p>
  <strong>Country:</strong>
  <%= @footprint.country %>
</p>

<% @foot_distance = @footprint.distance_to(@footprint.product.warehouse)*1.609 %>
<p>
  <strong>Distance:</strong>
  <%= @foot_distance.to_i %>km
</p>


<p>
  <strong>Latitude:</strong>
  <%= @footprint.latitude %>
</p>

<p>
  <strong>Longitude:</strong>
  <%= @footprint.longitude %>
</p>

<p>
  <strong>Result:</strong>
  <%= @footprint.result %>
</p>

<p>
  <strong>User:</strong>
  <%= @footprint.user.first_name %>
</p>

<p>
  <strong>Product:</strong>
  <%= @footprint.product_id %>
</p>





<%= link_to 'Edit', edit_footprint_path(@footprint.id) %> |

<br>
<hr>
<h3>Information de la ville de produit</h3>
<h6><%= "country: #{@country_product}"%></h6><br>
<h6><%= "City: #{@city_product}" %></h6><br>
<h6><%= "State: #{@state_product}"%></h6><br>
<h6><%= "Air Quality Index: #{@aqius_product} "%></h6>

<div class="card text-center">

  <div class="progress" >
    <% if @aqius_product <= 50 %>
    <div class="progress-bar bg-success"  style="width:100%"">
      Good
    </div>
    <% elsif  @aqius_product > 51 && @aqius_product <= 100 %>
    <div class="progress-bar bg-warning" style="width:100%">
      Moderate
    </div>
    <% elsif  @aqius_product >101 %>
    <div class="progress-bar bg-danger" style="width:100%" >
      Unhealthy for Sensitive Groups
    </div>
    <h4>Veuillez connecter pour voir la qualité de l'air de votre ville<h4>
  <% end %>
  </div>
</div>
<hr>
<div id='map'></div>
<div id='menu'>
<%# Switch layer %>
<input id='basic' type='radio' name='rtoggle' value='basic' checked='checked'>
<label for='basic'>basic</label>
<input id='streets' type='radio' name='rtoggle' value='streets'>
<label for='streets'>streets</label>
<input id='bright' type='radio' name='rtoggle' value='bright'>
<label for='bright'>bright</label>
<input id='light' type='radio' name='rtoggle' value='light'>
<label for='light'>light</label>
<input id='dark' type='radio' name='rtoggle' value='dark'>
<label for='dark'>dark</label>
<input id='satellite' type='radio' name='rtoggle' value='satellite'>
<label for='satellite'>satellite</label>
</div>


<%= javascript_tag do %>

var ENV = {
 MAPBOX_API: '<%= ENV['MAPBOX_API'] %>'
}
mapboxgl.accessToken =ENV['MAPBOX_API']

<%# switch layer: next 2 line %>
var layerList = document.getElementById('menu');
var inputs = layerList.getElementsByTagName('input');

var map = new mapboxgl.Map({
 container: 'map', // container id
 style: 'mapbox://styles/mapbox/navigation-preview-day-v4', // stylesheet location
 center: [2.56123,48.817038], // starting position
 zoom: 3 // starting zoom
});

var route = {
 type: 'FeatureCollection',
 features: [{
   type: 'Feature',
   geometry: {
     type: 'Point',
     coordinates: [<%= @footprint.product.warehouse.longitude %>,<%= @footprint.product.warehouse.latitude %>]
   },
   properties: {
     title: '<%= @footprint.product.title %>',
     description: '<%= @footprint.product.title %>,<%= @footprint.product.type.name %>'
   }
 },
 {
   type: 'Feature',
   geometry: {
     type: 'Point',
     coordinates: [<%= @footprint.longitude %>,<%= @footprint.latitude %>]
   },
   properties: {
     title: '<%= @footprint.user.first_name %>',
     description: '<%= @footprint.town %>,<%= @footprint.country %>'
   }
 }]
};


// add markers to map
route.features.forEach(function(marker) {

 // create a HTML element for each feature
 var el = document.createElement('div');
 el.className = 'marker';

 new mapboxgl.Marker(el)

 .setLngLat(marker.geometry.coordinates)
 .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
   .setHTML('<h3>' + marker.properties.title + '</h3><p>' + marker.properties.description + '</p>')
   )
   .addTo(map);
});


var directions = new MapboxDirections({
 accessToken: ENV['MAPBOX_API'],
 unit: 'metric',
 profile: 'mapbox/driving',

  container:'directions', // Specify an element thats not the map container.
  // UI controls
  controls: {
    inputs: false,
    instructions: true
  }

});
 directions.setOrigin([<%= @footprint.product.warehouse.longitude %>,<%= @footprint.product.warehouse.latitude %>])
 directions.addWaypoint(0,[<%= @footprint.product.warehouse.longitude + 0.1 %>,<%= @footprint.product.warehouse.latitude + 0.02 %>])
 directions.setDestination([<%= @footprint.longitude %>,<%= @footprint.latitude %>])



// add to your mapboxgl map
map.addControl(directions, 'top-left');
map.addControl(new mapboxgl.NavigationControl());

//Switch layer until the loop
function switchLayer(layer) {
var layerId = layer.target.id;
map.setStyle('mapbox://styles/mapbox/' + layerId + '-v9');
}

for (var i = 0; i < inputs.length; i++) {
inputs[i].onclick = switchLayer;
}

let hideWhenMouseover =document.querySelector('#map > div.mapboxgl-control-container > div.mapboxgl-ctrl-top-left > div > div')
	hideWhenMouseover.addEventListener("mouseover", function(){
      setInterval(function(){
      hideWhenMouseover.style.visibility = "hidden"
    },3000)
  });
<%end%>


</div>
</div></div></div></div></div>
